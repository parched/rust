language: c

runtime:
  nodePool: shippable_shared_aarch64

build:
  #pre_ci_boot:
  #  image_name: drydockaarch64/u16cppall
  #  image_tag: v6.7.4
  ci:
    - sudo apt-get update -y && sudo apt-get install cmake
    - git submodule update --init --recursive
    - cat /proc/sys/kernel/core_pattern
    - echo -e "[main]\nunpackaged=true" > ~/.config/apport/settings
    - echo "bt" > bt
    - ulimit -c unlimited && ./x.py build -vv; ls /var/crash/; apport-unpack /var/crash/* dump; gdb -batch -c dump/CoreDump -x bt
